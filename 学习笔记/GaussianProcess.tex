\documentclass[UTF8,a4paper]{ctexart}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx,float,array,color,bm,amsmath,amssymb }
\author{qhy}
\date{\today}
\title{Gaussian Process}
\begin{document}
    \maketitle
    \tableofcontents
    \newpage
    \section{Gaussian Process}
        \subsection{数学基础}
        在GP中需要用到的数学知识,这里给出结论,证明见PRML第二章。
            \subsubsection{高斯分布}
            给定一个联合高斯分布$\mathcal{N}(\bm{x}|\bm{\mu,\Sigma})$,其中$\bm{\Lambda} \equiv \bm{ \Sigma^{-1}}$,且
            \begin{equation}
                \bm{x} = \left ( \begin{array}{l}
                \bm{x_a} \\
                \bm{x_b}
                \end{array}
                \right ),
                \bm{\mu} = \left ( \begin{array}{l}
                \bm{\mu_a} \\
                \bm{\mu_b}
                \end{array}
                \right )
            \end{equation}
            \begin{equation}
                \bm{\Sigma} = \left (
                \begin{array}{cc}
                \bm{\Sigma_{aa}} & \bm{\Sigma_{ab}}\\
                \bm{\Sigma_{ba}}& \bm{\Sigma_{bb}}
                \end{array} \right ),
                \bm{\Lambda} = \left (
                \begin{array}{cc}
                \bm{\Lambda_{aa}} & \bm{\Lambda_{ab}}\\
                \bm{\Lambda_{ba}}& \bm{\Lambda_{bb}}
                \end{array}\right )
            \end{equation}

            有以下两个结论:

            \textbf{条件概率分布:}
            \begin{equation}
                p(\bm{x_a}|\bm{x_b}) = \mathcal{N}(\bm{x_a}|\bm{\mu_{a|b}},\bm{\Lambda_{aa}^{-1}})
            \end{equation}
            \begin{equation}
                \bm{\mu_{a|b}} = \bm{\mu_a} - \bm{\Lambda_{aa}^{-1}\Lambda_{ab}(x_b - \mu_b)}
            \end{equation}
            或
            \begin{equation}
                \bm{\mu_{a_b}} = \bm{\mu_a + \Sigma_{ab}\Sigma_{bb}^{-1}(x_b - \mu_a)}
            \end{equation}
            \begin{equation}
                \bm{\Sigma_{a|b}= \Sigma_{aa} - \Sigma_{ab}\Sigma_{bb}^{-1}\Sigma_{ba}}
            \end{equation}

            \textbf{边缘概率分布:}
            \begin{equation}
                p(\bm{x_a}) = \mathcal{N}(\bm{x_a|\mu_a,\Sigma_{aa}})
            \end{equation}

            {\color{blue}这里证明了边缘概率和联合分布之间的关系,当我们在求边缘概率的时候,就可以通过求联合分布得到(这里在计算的时候省略的积分的过程,但实际的证明就是通过积分证明得到的。)}

            \subsubsection{高斯变量的贝叶斯定理}

            给定$\bm{x}$的一个边缘高斯分布,以及在给定$\bm{x}$的条件下的$\bm{y}$的条件高斯分布,形式为:
            \begin{equation}
                p(\bm{x}) = \mathcal{N}(\bm{x}|\bm{\mu},\bm{\Lambda^{-1}})
            \end{equation}
            \begin{equation}
                p(\bm{y}|\bm{x}) = \mathcal{N}(\bm{y}|\bm{Ax + b,L^{-1}})
            \end{equation}
            $\bm{y}$的边缘分布以及给定$\bm{y}$条件下的$\bm{x}$的条件分布为:
            \begin{equation}
                p(\bm{y}) = \mathcal{N}(\bm{y}|\bm{Ax + b,L^{-1} + A\Lambda^{-1}A^{T}})
            \end{equation}
            \begin{equation}
                p(\bm{x|y}) = \mathcal{N}(\bm{x}|\Sigma\{\bm{A^TL(y-b)+\Lambda\mu}\},\bm{\Sigma})
            \end{equation}
            其中,
            \begin{equation}
                \bm{\Sigma} = (\bm{\Lambda + A^TLA})^{-1}
            \end{equation}

        \subsection{随机过程与高斯过程}
        \textbf{随机过程}:许多随机变量的集合

        \textbf{高斯过程}:许多高斯随机变量的集合

        e.g. 给定n个随机变量:$\bm{y} = \{y_1 , y_2 , \cdots , y_n\}$,其中$y_i\sim \mathcal{N}(\bm{\mu} , \bm \Sigma )$

        高斯随机过程就是:
        \begin{equation}
            \left [
                \begin{array}{c}
                \bm y_1 \\
                \bm y_2\\
                \vdots \\
                \bm y_n
                \end{array}
            \right ]
        \end{equation}

        {\color{blue} 没错,就是这些随机变量的集合。在求这个随机过程的分布的时候,实际上就是求这些随机变量的联合分布。然后,随机过程到底结束。}

        \subsection{高斯过程回归  Gaussian Process Regression}
            \subsubsection{无噪声GPR}
            \textbf{问题描述:}给定样本$\mathcal{D} = \{ (x_1, y_1) , \cdots , (x_n , y_n) \}$,和待预测数据$x_*$,相似性矩阵$\bm K$,求$p(y_*| \mathcal{D})$

            高斯过程回归:假设目标函数是一条平滑的曲线,在相近的之间,其输出也相近。也就是相近的随机变量(它们采样的值也相近),而这个距离则是通过$x$来确定的,这就保证的相邻的$x$之间的曲线的平滑度(曲线不会突然飙到一个很大或者很小的值)。

            下面看高斯过程回归的具体过程:

            把每个样本的$y_i$当作随机变量,并且假设这些随机变量满足高斯分布(即,这些随机变量组成高斯过程)。

            i.e. $y_i \sim \mathcal{N}(\mu_i,\Sigma_{ii})$

            则这个高斯过程满足以下条件:{\color{blue}由前面的数学公式可以得到}
            \begin{equation}
                \bm{y}  \triangleq \left [
                    \begin{array}{c}
                     y_1 \\
                     y_2\\
                    \vdots \\
                     y_n
                    \end{array}
                \right ] \sim \mathcal{N}(\bm{\mu} , \bm{K})
            \end{equation}

            注:$\triangleq$表示定义的意思

            其中,
            \begin{equation}
                \bm \mu = \left [
                    \begin{array}{c}
                    \bm \mu_1 \\
                    \bm \mu_2\\
                    \vdots \\
                    \bm \mu_n
                    \end{array}
                \right ]
            \end{equation}

            其中$\bm{K}$为相似性矩阵,用来描述随机变量之间的距离。
            \begin{equation}
                K_{nm} = k(\bm{x_n} , \bm x_m) = \frac{1}{\alpha}\phi(x_n)^T\phi(x_m)
            \end{equation}

            根据前面随机变量的定义,有
            \begin{equation}
                K_{ii} = \Sigma_{ii}
            \end{equation}

            给定$x_*$,假设
            \begin{equation}
                \left [ \begin{array}{c}
                    \bm{y} \\ y_*
                \end{array} \right ] \sim \mathcal{N}
                \left (
                    \left [\begin{array}{c}
                    \bm{mu} \\ \mu_*
                    \end{array} \right ] ,
                    \left [\begin{array}{cc}
                    \bm{K} & \bm{K_*} \\
                    \bm{K_*^T} & k_{**}
                    \end{array} \right ]
                \right )
            \end{equation}

            其中,
            \begin{equation}
                \bm{K_*^T} = [ k(\bm x_1,\bm x_*) , \cdots , k(\bm x_n , \bm x_*) ]
            \end{equation}

            根据第一部分的数学知识,我们有以下结果:
            \begin{equation}
                p(y_* | \bm y)  = \mathcal{N}( \bm \tilde \mu ,  \bm  \tilde \Sigma)
            \end{equation}

            其中,
            \begin{equation}
                \bm \tilde \mu = \mu_* + \bm K_*^T\bm K^{-1}(\bm y - \bm \mu)
            \end{equation}

            \begin{equation}
                 \bm \tilde \Sigma = k_{**} - \bm K_*^T\bm K^{-1}\bm K_*
            \end{equation}

            {\color{blue}一般地,我们对均值没有任何的先验知识,根据对称性,我们取$\mu = \mu_* = \bm 0$}

\end{document}
