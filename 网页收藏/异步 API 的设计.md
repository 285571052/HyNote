# 异步 API 的设计

网站的前后端通信，往往会有异步请求，这时应该怎么设计 API？

如果服务器不能立即返回结果，就形成了异步操作。 客户端的请求还是一样的。

1. 请求, 返回accepted
    202 Accepted告诉客户端，请求已经接受，但还没有处理，可以去Location字段查询进展
    除了上面的头信息，服务器的回应如果有数据体，可以返回一些有效信息（比如任务完成的估计时间、当前状态等等）。

2. 查询进展
    过了一段时间，客户端就发出请求，查询异步处理的进展

3. 异步操作成功后
    重定向: 有一种特殊情况，用户查询异步操作的进展的时候，可能会希望，如果异步操作已经完成，就直接跳转到新资源。
    告诉客户端，重定向到不同的资源。Location字段就是跳转的目标，也就是新资源的网址。

4. 删除查询链接
    一旦异步操作完成，客户端可以要求服务器删除查询链接。
    如果客户端不删除查询链接，服务器完成异步任务后，也可以自动删除。客户端再请求这个链接，服务器回应

[异步 API 的设计][1]

[1]: http://www.ruanyifeng.com/blog/2018/12/async-api-design.html
