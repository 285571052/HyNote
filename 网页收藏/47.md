<article id="post-利用telnet发邮件" class="article article-type-post" itemscope="" itemprop="blogPost"><div class="article-meta">
<a href="/2017/03/28/利用telnet发邮件/" class="article-date"><time datetime="2017-03-28T12:20:58.000Z" itemprop="datePublished">2017-03-28</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 class="article-title" itemprop="name">利用telnet发邮件</h1>
</header>
<div class="article-info article-info-post">
<div class="clearfix"></div>
</div>
<div class="article-entry" itemprop="articleBody">

<p>玩了下telnet发邮件，仅作记录，如有不妥请见谅。</p>
<a id="more"></a>
<p>常用的邮件协议有smtp和pop3（IMAP为升级版）。smtp用于不同邮件服务器之间的通讯和用户客户端向服务器投递邮件。pop3仅用于用户客户端从服务器取回邮件。smtp默认端口25，pop3默认端口110。</p>
<p>outlook就是常见的邮件客户端。</p>
<p>服务器与服务器之间投递邮件和用户客户端向服务器投递邮件本来是不需要任何验证的，但由于垃圾邮件的影响，现一般用户使用客户端向服务器投递邮件需要身份验证。注意，服务器之间的投递还是无需验证的，并且这里的投递和接收都是使用smtp协议。那么，服务器是怎么区别对待的呢？我们用outlook之类的邮件客户端时需要设置一个smtp服务器，这个smtp服务器地址一般在邮件服务商那里有直接提供，如qq邮箱的是smtp.qq.com。而邮件服务器之间投递邮件却使用的是另一个smtp服务器，这时使用的smtp服务器由dns解析获得，如查看qq的mx解析记录有mx1.qq.com、mx2.qq.com、mx3.qq.com，向三个其中一个投递即可。</p>
<p>我试了telnet方式模拟使用客户端借助登录163邮箱来向qq邮箱发送邮件，失败了，被当成垃圾邮件，不给发送；想从qq发向163，需要使用ssl的方式，不会搞，放弃了。嗯，试了下服务器投递的方式，直接向qq的mx*.qq.com投递，这个可以。下面过程：</p>
<p>利用nslookup查看qq邮箱的无需验证的smtp服务器（供给其它邮件服务器向其投递邮件的服务器）：<br></p><figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="0"><span class="line">&gt;nslookup</span><br><span class="line">默认服务器:  public1.<span class="number">114</span>dns<span class="class">.com</span></span><br><span class="line">Address:  <span class="number">114.114</span>.<span class="number">114.114</span></span><br><span class="line"></span><br><span class="line">&gt; set type=mx</span><br><span class="line">&gt; qq<span class="class">.com</span></span><br><span class="line">服务器:  public1.<span class="number">114</span>dns<span class="class">.com</span></span><br><span class="line">Address:  <span class="number">114.114</span>.<span class="number">114.114</span></span><br><span class="line"></span><br><span class="line">非权威应答:</span><br><span class="line">qq<span class="class">.com</span>  MX preference = <span class="number">10</span>, mail exchanger = mx3<span class="class">.qq</span><span class="class">.com</span></span><br><span class="line">qq<span class="class">.com</span>  MX preference = <span class="number">20</span>, mail exchanger = mx2<span class="class">.qq</span><span class="class">.com</span></span><br><span class="line">qq<span class="class">.com</span>  MX preference = <span class="number">30</span>, mail exchanger = mx1<span class="class">.qq</span><span class="class">.com</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>由上可知道qq邮箱的三个smtp服务器，利用telnet连上：<br></p><figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="1"><span class="line">&gt; telnet mx1<span class="class">.qq</span><span class="class">.com</span> <span class="number">25</span></span><br><span class="line">Host <span class="string">'mx1.qq.com'</span> resolved to <span class="number">183.57</span>.<span class="number">48.35</span>.</span><br><span class="line">Connecting to <span class="number">183.57</span>.<span class="number">48.35</span>:<span class="number">25</span>...</span><br><span class="line">Connection established.</span><br><span class="line">To escape to local shell, press <span class="string">'Ctrl+Alt+]'</span>.</span><br><span class="line"><span class="number">220</span> newmx17<span class="class">.qq</span><span class="class">.com</span> MX QQ Mail Server</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>打招呼自我介绍~：<br></p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="2"><span class="line">&gt; ehlo Coande</span><br><span class="line"><span class="number">250</span>-newmx17.qq.com</span><br><span class="line"><span class="number">250</span>-SIZE <span class="number">73400320</span></span><br><span class="line"><span class="number">250</span>-STARTTLS</span><br><span class="line"><span class="number">250</span> OK</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>设置邮件哪里来：<br></p><figure class="highlight groovy"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="3"><span class="line">&gt; mail <span class="string">from:</span> &lt;coande<span class="annotation">@e</span>12e.com&gt;</span><br><span class="line"><span class="number">250</span> Ok</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>设置交给谁：<br></p><figure class="highlight autoit"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="4"><span class="line">&gt; rcpt <span class="keyword">to</span>: &lt;e12e<span class="constant">@qq</span>.com&gt;</span><br><span class="line"><span class="number">250</span> Ok</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>开始写邮件：<br></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="5"><span class="line">&gt;data</span><br><span class="line">354 End data with <span class="tag">&lt;<span class="title">CR</span>&gt;</span><span class="tag">&lt;<span class="title">LF</span>&gt;</span>.<span class="tag">&lt;<span class="title">CR</span>&gt;</span><span class="tag">&lt;<span class="title">LF</span>&gt;</span></span><br><span class="line">&gt; just test!</span><br><span class="line">&gt; .</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>输入data后显示文字提示，紧跟着就可以填写内容了，要结束，键入<code>enter</code>然后输入<code>.</code>再<code>enter</code>会显示ok字样即为成功，我这次提示：<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="6"><span class="line">550 Ip frequency limited. http://service.mail.qq.com/cgi-bin/<span class="operator"><span class="keyword">help</span>?<span class="keyword">subtype</span>=<span class="number">1</span>&amp;&amp;<span class="keyword">id</span>=<span class="number">20022</span>&amp;&amp;<span class="keyword">no</span>=<span class="number">1000725</span></span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>ip被限制了。。。</p>
<p>稍等就可以去自己的收件箱查收邮件了，有一定几率会呆在垃圾箱。</p>
<p>伪造发件人原理：在输入data后，这样写：<br></p><figure class="highlight markdown"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="7"><span class="line"><span class="blockquote">&gt; from: &lt;laowang@e12e.com&gt;</span></span><br><span class="line"><span class="blockquote">&gt; subject: i just a subject</span></span><br><span class="line"><span class="blockquote">&gt; </span><br><span class="line">&gt; just test!</span></span><br><span class="line"><span class="blockquote">&gt; .</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>收件人收到邮件时，显示的就是data里的邮件地址了，subject是邮件主题。但亲测，不知道为啥发给qq邮箱时，多了一些乱码以致data中的from和subject无效，直接在邮件内容中显示出来了。</p>
<p>另：模拟客户端的方式发送邮件，出现如下字眼时：<br></p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre data-initialized="true" data-gclp-id="8"><span class="line"><span class="number">250</span>-AUTH LOGIN PLAIN</span><br><span class="line"><span class="number">250</span>-AUTH=LOGIN</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>输入：<br></p><figure class="highlight markdown"><table><tbody><tr><td class="gutter"><pre data-initialized="true"><span class="line">1</span><br></pre></td><td class="code"><pre data-initialized="true"><span class="line"><span class="blockquote">&gt; auth login</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>然后出现<code>username:</code>base64后的字符串，这时要输入base64编码后的用户名；再然后是<code>password:</code>经过base64编码后的字符串，输入base64编码后的密码即可。</p>
<p>在操作过程中的输入必须要按照顺序一个字符一个字符的输入，不能颠倒顺序输入。输入过程中可能会遇到明明输入的是正确的，但是却报<code>502 Error: command not implemented</code>，多试几次就行了。</p>


</div>

</div>


<nav id="article-nav">


<a href="/2017/03/14/IE浏览器的一个巨坑/" id="article-nav-older" class="article-nav-link-wrap">
<div class="article-nav-title">IE浏览器的一个巨坑</div>
<strong class="article-nav-caption">&gt;</strong>
</a>

</nav>


</article>